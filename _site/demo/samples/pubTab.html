<!doctype html>
<HTML>
<HEAD>
<TITLE>pub Tab-예제</TITLE>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
	<link href="../theme/default/pub.example.css" rel="stylesheet">
	<link href="../theme/default/pub.tab.css" rel="stylesheet">

	<script src="../plugins/jquery-1.10.2.min.js"></script>
	<script src="../dist/pub.tab.js"></script>

<style>

</style>
</HEAD>
<BODY>
	<div id="pubTabId" style="width:300px">
	</div>
-------------------------------<br/>
	<div id="asdfasdf" style="width:300px">
		<div class="pub-tab-wrapper">
			<div class="pub-tab" data-mode="vertical">
				<span class="pub-tab-prev">앞</span>
				<ul class="pub-tab-container">
					<li class="pub-tab-item ui-state-default ui-corner-top ui-state-active" contentid="tables" contenturl="tables" refresh="N"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Tables</span></li><li class="pub-tab-item ui-state-default ui-corner-top" contentid="views" contenturl="views"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Views</span></li><li class="pub-tab-item ui-state-default ui-corner-top" contentid="procedures" contenturl="procedures"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Procedures</span></li><li class="pub-tab-item ui-state-default ui-corner-top" contentid="functions" contenturl="functions"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Functions</span></li>
					<li class="pub-tab-item ui-state-default ui-corner-top ui-state-active" contentid="tables" contenturl="tables" refresh="N"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Tables</span></li><li class="pub-tab-item ui-state-default ui-corner-top" contentid="views" contenturl="views"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Views</span></li><li class="pub-tab-item ui-state-default ui-corner-top" contentid="procedures" contenturl="procedures"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Procedures</span></li><li class="pub-tab-item ui-state-default ui-corner-top" contentid="functions" contenturl="functions"><span href="#tabs-3" class="left-menu-ui-tabs-anchor" role="presentation" tabindex="-1" id="ui-id-3">Functions</span></li>
				</ul>
				<span class="pub-tab-next">뒤</span>
			</div>
		</div>
	</div>
</BODY>
</HTML>
<script>
$(document).ready(function (e){
	var aaa = 'Tables	Views	Procedures	Functions'.split('\t');
		
	for(var i =0 ;i <aaa.length; i++){
		aaa[i] = {
			test1 : aaa[i]
		}
	}
	/*
	for(var i =aaa.length ;i <10; i++){
		aaa.push({
			title:'asdf'+i
		})
	}
	*/

	$.pubTab('#pubTabId',{
		items :aaa
		,width:'auto'
		,click : function (item){
			console.log(item);
		}
		,itemKey :{							// item key mapping
			title :'test1'
		}
	})
})
</script>

<script>

/**
 * pubTab v0.0.1
 * ========================================================================
 * Copyright 2016 ytkim
 * Licensed under MIT
 * http://www.opensource.org/licenses/mit-license.php
*/

;(function ($, window, document, undefined) {
"use strict";
    var pluginName = "pubTab"
		,_datastore = {}
		,defaults = {
			speed : 150
			,width:300
			,filter: function ($obj) {
				// Modify $obj, Do not return
			}
			,icon :{
				prev :'<'
				,next : '>'
			}
			,addClass : 'service_menu_tab'	// tab li 추가 클래스
			,items:[]							// tab item
			,click :function (item){			// tab click 옵션
				
			}
			,itemKey :{							// item key mapping
				title :'name'
			}
		};
        
    function Plugin(element, options) {
        this.selector = (typeof element=='object') ? element.selector : element;
		this.contextId = 'pubTab-'+new Date().getTime();
		this.element = $(element);
        this.options = $.extend({}, defaults, options);
		
		this.init();
	
		return this; 
    }

	Plugin.prototype ={
		init :function(){
			var _this =this; 

			_this.config = {};
			_this.draw();

			_this.initEvt();

		}
		,initEvt : function (){
			var _this = this; 

			_this.element.find('.pub-tab-item-cont').on('click', function (e){
				var sEle = $(this); 

				_this.element.find('.pub-tab-item-cont.active').removeClass('active');
				sEle.addClass('active')

				if($.isFunction(_this.options.click)){
					var tabIdx = sEle.attr('data-tab-idx');

					
					_this.options.click.call(this,_this.options.items[tabIdx])
				}
			})
			
			var prevElement = _this.element.find('.pub-tab-prev')
				, nextElement = this.element.find('.pub-tab-next');
			
			var prevTimerObj = null;
			prevElement.on( "mouseenter", function (e){
				var scrollLeft = _this.config.tabScrollElement.scrollLeft();
				function movePrev(){
					_this.config.tabScrollElement.scrollLeft(scrollLeft-10);
					prevTimerObj = setTimeout(function(){
						scrollLeft = _this.config.tabScrollElement.scrollLeft();
						movePrev()
					}, _this.options.speed);
				}

				movePrev();	
			}).on( "mouseleave", function (e){
				clearTimeout(prevTimerObj);
			});
			
			var nextTimerObj = null;
			nextElement.on( "mouseenter", function (e){
				var scrollLeft = _this.config.tabScrollElement.scrollLeft();
				function moveNext(){
					_this.config.tabScrollElement.scrollLeft(scrollLeft+10);
					nextTimerObj = setTimeout(function(){
						scrollLeft = _this.config.tabScrollElement.scrollLeft();
						moveNext()
					}, _this.options.speed);
				}
				
				prevElement.show();
				
				moveNext();	
			}).on( "mouseleave", function (e){
				clearTimeout(nextTimerObj);
			});

			/*
			prevElement.on('click', function (e){
				var scrollLeft = _this.config.tabScrollElement.scrollLeft();
				
				_this.config.tabScrollElement.scrollLeft(scrollLeft-10);

				if(scrollLeft-20 < 0){
					prevElement.hide();
				}

			})

			nextElement.on('click', function (e){
				var scrollLeft = _this.config.tabScrollElement.scrollLeft();
				_this.config.tabScrollElement.scrollLeft(scrollLeft+10);

				if(scrollLeft > 0){
					prevElement.show();
				}
			})
			*/
		}
		,setWidth : function (val){
			
			val = val || this.options.width;

			val = val =='auto' ? this.element.width():val;

			this.options.width = val; 
			$('#'+this.contextId+'pub-tab').css('width',val);
			this.config.tabScrollElement.css('width',val);

			if(this.config.tabContainerElement.width() >= this.options.width){
				$('#'+this.contextId+'pub-tab-move-space').show();
				this.element.find('.pub-tab-move-area').show();
			}else{
				$('#'+this.contextId+'pub-tab-move-space').hide();
				this.element.find('.pub-tab-move-area').hide();
			}
		}
		,destory:function (){
			
		}
		,draw : function (){
			var _this = this
				,items = _this.options.items
				,itemLen = items.length; 
			
			function tabItemHtml (){
				var tabHtm = [];
				var titleKey = _this.options.itemKey.title;
				for(var i = 0 ;i < itemLen ;i++){
					var item = items[i];
					tabHtm.push('<li class="pub-tab-item '+(i+1==itemLen ? 'last':'')+'"><span class="pub-tab-item-cont '+_this.options.addClass+'" data-tab-idx="'+i+'">'+item[titleKey]+'</span></li>');
				}
				return tabHtm.join('');
			}

			var strHtm = [];
			strHtm.push('<div class="pub-tab-wrapper">');
			strHtm.push('	<div id="'+_this.contextId+'pub-tab" class="pub-tab">');
			strHtm.push('		<div id="'+_this.contextId+'pub-tab-scroll" class="pub-tab-scroll">');
			strHtm.push('			<ul id="'+_this.contextId+'pub-tab-container" class="pub-tab-container">');
			strHtm.push(tabItemHtml());
			strHtm.push('			<li><div id="'+_this.contextId+'pub-tab-move-space"  style="display:none;">&nbsp;</div></li>');
			strHtm.push('			</ul>');
			strHtm.push('		</div> ');
			strHtm.push('		<div class="pub-tab-move-area"> ');
			strHtm.push('			<span class="pub-tab-prev">'+_this.options.icon.prev+'</span>');
			strHtm.push('			<span class="pub-tab-next">'+_this.options.icon.next+'</span>');
			strHtm.push('		</div>');
			strHtm.push('	</div>');
			strHtm.push('</div>');

			_this.element.empty().html(strHtm.join(''));
					
			_this.config.tabContainerElement =  $('#'+_this.contextId+'pub-tab-container');
			_this.config.tabScrollElement = $('#'+_this.contextId+'pub-tab-scroll');


			$('#'+_this.contextId+'pub-tab-move-space').css('width',this.element.find('.pub-tab-move-area').width());
			_this.setWidth();
		}
		,setScrollInfo : function (){
			this.config.scroll = {
				width : this.config.tabContainerElement.width() - _this.config.tabScrollElement.width()	
			} 
		}
	};

    $[ pluginName ] = function (selector,options) {

		if(!selector){
			return ; 
		}

		var _cacheObject = _datastore[selector];

		if(typeof options === undefined){
			return _cacheObject; 
		}
		
		if(!_cacheObject){
			_cacheObject = new Plugin(selector, options);
			_datastore[selector] = _cacheObject;
			return _cacheObject; 
		}else if(typeof options==='object'){
			_cacheObject = new Plugin(selector, options);
			_datastore[selector] = _cacheObject;
			return _cacheObject; 
		}

		if(typeof options === 'string'){
			var callObj =_cacheObject[options]; 
			if(typeof callObj ==='undefined'){
				return options+' not found';
			}else if(typeof callObj==='function'){
				return _cacheObject[options].apply(_cacheObject,args);
			}else {
				return typeof callObj==='function'; 
			}
		}

		return _cacheObject;	
    };

})(jQuery, window, document);

</script>

