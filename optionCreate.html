<!doctype html>

<html>
<title>옵션생성</title>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="/assets/css/bootstrap.min.css" rel="stylesheet">
<link href="/assets/css/font-awesome.min.css" rel="stylesheet" type="text/css" />
<link href="/assets/css/pub-style.css" rel="stylesheet">

<script src="/assets/js/jquery.min.js"></script>
<script src="/assets/js/jquery-ui.min.js"></script>
<script src="/assets/js/mustache/mustache.min.js"></script>
        
<style>
html, body{
    width:100%;
    height:100%;
}

.content-body{
    width:100%;
}
.content-body td{
    border: 1px solid #807d7d;
    vertical-align: top;
    height: 20px;
}
.result-area{
    height: 600px;
}
#optionText{
    height: 100%;
    width:100%;
}
#optPreviewArea{
    border: 1px solid #807d7d;
    min-height:  440px;
}

.result-html-area{
    width: 100%;
    background: #ffffff;
}
.result-html-area thead th{
    text-align: center;
}

.result-html-area tbody td{
    vertical-align: top;
    border: 1px solid #747272;
    background: #ffffff;

}
</style>
</head>

<body>
    <table class="content-body">
        <tr>
            <td>
             옵션   
            </td>
            <td>
                <a href="javascript:;" class="opt-change">html 변경.</a> 
            </td>
        </tr>
        <tr>
            <td>
<textarea id="optionText">
    {
        borderSpace : 2 // width board space
        ,rowOptions:{
            height: 22	// cell 높이
            ,click : false //row(tr) click event
            ,contextMenu : false // row(tr) contextmenu event
            ,addStyle : false	// 추가할 style method
        }
        ,useDefaultFormatter :false
        ,formatter :{
            money :{prefix :'$', suffix :'원' , fixed : 0}	// money 설정 prefix 앞에 붙일 문구 , suffix : 마지막에 뭍일것 , fixed : 소수점 
            ,number : {prefix :'$', suffix :'원' , fixed : 0}
        }
        ,autoResize : {
            enabled:true
            ,responsive : true // 리사이즈시 그리드 리사이즈 여부.
            ,threshold :150
        }
        ,headerOptions : {
            view : true	// header 보기 여부
            ,height: 23
            ,sort : false	// 초기에 정렬할 값
            ,redraw : true	// 초기에 옵션 들어오면 새로 그릴지 여부.
            ,resize:{	// resize 여부
                enabled : true
                ,cursor : 'col-resize'
                ,update : false	// 변경시 콜랙 함수
            }
            ,isColSelectAll : true	// 전체 선택 여부.
            ,colFixedIndex : 0	// 고정 컬럼 
            ,colWidthFixed : false  // 넓이 고정 여부.
            ,colMinWidth : 50  // 컬럼 최소 넓이
            ,colMaxWidth : 500  // 컬럼 최대 넓이
            ,oneCharWidth: 7
            ,viewAllLabel : true
            ,contextMenu : false // header contextmenu event
            
        }
        ,setting : {
            enabled : false
            ,enableSpeed : false
            ,enableSearch : true
            ,enableColumnFix : false
            ,click : false		// 직접 처리 할경우. function 으로 처리.
            ,speedMaxVal :10
            ,callback : function (item){
                
            }
            ,configVal :{
                search :{			// 검색
                    field : ''		// 검색 필드
                    ,val : ''		// 검색어
                }
                ,speed :-1			// scroll speed
                ,fixColumnPosition : -1	// fixed col position
            }
            ,util : {
                searchFilter : function (item, key,searchVal){
                    var itemVal = (item[key]||'');
                    if(itemVal.toLowerCase().indexOf(searchVal) > -1){
                        return true; 
                    }
                    return false;
                }
            }
        }
        ,asideOptions :{
            lineNumber : {
                enabled :false
                ,key : 'lineNumber'
                ,charWidth : 9
                ,name : ''
                ,width : 40
                ,styleCss : ''	//css 
                ,isSelectRow:true
            }
            ,rowSelector :{
                enabled :false
                ,key : 'checkbox'
                ,name : 'V'
                ,width : 25
            }
            ,modifyInfo :{
                enabled :false
                ,key : 'modify'
                ,name : 'modify'
                ,width : 10
            }
        }
        ,bodyOptions : {
            cellDblClick : false	// body td click
            ,valueFilter : false	// cell value filter
        }
        ,scroll :{
            isPreventDefault : true	// 이벤트 전파 여부.	
            ,vertical : {
                width : 12
                ,bgDelay : 100		// 스크롤 빈공간 mousedown delay
                ,btnDelay : 100		// 방향키 mousedown delay
                ,speed :  'auto'	// 스크롤 스피드
                ,onUpdate : function (item){	// 스크롤 업데이트. 
                    return true; 
                }
                ,tooltip : false		// item count tooltip
            }
            ,horizontal :{
                height: 12
                ,bgDelay : 100		
                ,btnDelay : 100		// 방향키 버튼 속도.
                ,speed : 1			// 스크롤 스피드
            }
        }
        ,selectionMode : 'multiple-cell'	// row , cell , multiple-row , multiple-cell	// 선택 방법. 
        ,theme : 'light'
        ,height: 'auto'
        ,itemMaxCount : -1	// add시 item max로 유지할 카운트
        /*
        tColItem  object info
        {
            "key": "b"	// key
            ,"label": "비"	// label
            ,"width": 100		// width
            ,"sort": true		// sort flag
            ,"align": "center"	// align
            ,"type": "money"		// value type
            ,"render": "html"		// render mode
            ,colClick :function (idx,item){ console.log(idx, item)}		// cell click event
            ,styleClass : function (idx, item){return 'pub-bg-private';}	// cell add class
        }
        */
        ,tColItem : [] //head item 
        ,theadGroup : [] // head group 
        ,tbodyItem : []  // body item
        ,tbodyGroup : [] // body group 
        ,tfootItem : []  // foot item
        ,page : false	// paging info
        ,message : {
            empty : 'no data'
            ,pageStatus : function (status){
                return status.currStart +' - ' + status.currEnd+' of '+ status.total;
            }
        }
        ,i18n :{
            'setting.label' : '설정'
            ,'search.button' : '검색'
            ,'setting.speed.label' : '스크롤속도'
            ,'setting.column.fixed.label' : '고정컬럼'
        }
        ,icon : {
            'sortup' : '<svg width="8px" height="8px" viewBox="0 0 110 110" style="enable-background:new 0 0 100 100;"><g><polygon points="50,0 0,100 100,100" fill="#737171"></polygon></g></svg>'
            ,'sortdown' : '<svg width="8px" height="8px" viewBox="0 0 110 110" style="enable-background:new 0 0 100 100;"><g><polygon points="0,0 100,0 50,90" fill="#737171"></polygon></g></svg>'
        }	
    }
</textarea>
            </td>
            <td>
<div class="result-area">
    result code
    <textarea id="changeHTml" style="width:100%;" rows="4"></textarea>
    
    result html
    <table class="result-html-area">
        <thead>
            <tr>
                <th>옵션명</th>
                <th>옵션값</th>
            </tr>
        </thead>
        <tbody id="optPreviewArea">

        </tbody>
    </table>
</div>
            </td>
        </tr>
    </table>
    
</body>
</html>

<script>
var optionsChg = {
    init : function (){
        this.initEvt();
    }
    ,initEvt : function (){
        var _this =this; 

        $('.opt-change').on('click',function (){
            _this.change();
        });


    }
    ,change : function (){
        var optText = $('#optionText').val();

        var optObj = new Function('return '+ optText+';')();

        var strHtm = [];

        
        for(var key in optObj){
            var optObjVal = optObj[key]; 
            strHtm.push('<tr>');
            strHtm.push('<td>'+key+'</td>');
            
            strHtm.push('<td>'+this.getOptValTab(key,optObjVal)+'</td>');
            strHtm.push('<tr>')

        }

        $('#optPreviewArea').empty().html(strHtm.join(''));
    }
    ,getOptValTab : function (key,optObjVal){
        var strHtm = [];
        if($.isNumeric(optObjVal)){
            return this.getSelectBoxVal(key,optObjVal);
        }else if(typeof optObjVal=== 'boolean'){
            var flag = optObjVal ==true;  
            strHtm.push('<input type="radio" data-key="'+key+'" name="'+key+'" class="item-val" value="true" '+(flag===true?'checked':'')+'>true')
            strHtm.push('<input type="radio" data-key="'+key+'" name="'+key+'" class="item-val" value="false" '+(flag===false?'checked':'')+'>false')
        }

        return strHtm.join('');
    }
    ,getSelectBoxVal:function (key,optObjVal){
        var reval = [];
        reval.push('<select class="item-val" data-key="'+key+'">')
        if(optObjVal== -1){
            reval.push('<option value="-1" selected>-1<option>');
            for(var i=1; i<= 5;i++){
                var val = i*1000;
                reval.push('<option value="'+val+'">'+val+'<option>');
            }
        }else{
            for(var i=0; i<= 10;i++){
                var val = i;
                reval.push('<option value="'+val+'" '+(i==optObjVal?'selected':'')+'>'+val+'<option>');
            }
        }
        reval.push('<select>')

        return reval.join('');
    }
}

optionsChg.init();
</script>


